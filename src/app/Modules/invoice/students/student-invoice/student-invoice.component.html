<div class="main-content">
    <div class="row view-page">
        <div class="col-12">
            <div class="custom-view-list student-view-list">
                <div class="custom-view-div franchise-name">
                    <div>{{'invoices.list.month'|translate}}
                        <span>{{month}} {{year}}</span>
                    </div>
                </div>
                <div class="custom-view-div">
                    <div class="schools-text">{{'invoices.list.#invoice'|translate}}
                        <span>{{invoiceCount}}</span>
                    </div>
                </div>
                <div class="custom-view-div">
                    <div class="schools-text">{{'invoices.list.#invoiceAmount'|translate}}
                        <span>₹ {{totalInvoiceAmount | number}}</span>
                    </div>
                </div>
                <div class="custom-view-div">
                    <div class="schools-text">{{'invoices.list.collectedAmount'|translate}}
                        <span>₹ {{invoiceCollectedAmount | number}}</span>
                    </div>
                </div>
                <div class="custom-view-div">
                    <div class="payment-text">{{'invoices.list.due'|translate}}
                        <span>₹ {{dueAmount | number}}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- For Form starts-->
    <form [formGroup]="filtersForm" (ngSubmit)="submit()">
        <div class="custom-search justify-content-between">
            <div class="d-flex custom-form">
                <div class="col-md-4 p-0 filter-form">
                    <p-calendar name="from_date" [showIcon]="true"  formControlName="from_date" dateFormat="dd/mm/yy"
                       [maxDate]="maxDate" showButtonBar="true" [clear]= 'Clear' placeholder="{{'placeholder.invoiceFromDate'|translate}}">
                </p-calendar>
                </div>
                <div class="col-md-4 p-0 filter-form ml-2">
                    <p-calendar name="to_date" [showIcon]="true" formControlName="to_date"
                         dateFormat="dd/mm/yy" showButtonBar="true" [clear]= 'Clear'
                        [maxDate]="maxDate" placeholder="{{'placeholder.invoiceToDate'|translate}}">
                    </p-calendar>
                </div>
                <div class="input-dropdown ml-2">
                    <p-dropdown [options]="invoiceStatus" placeholder="{{'placeholder.status'|translate}}"
                        styleClass="ui-column-filter"
                         [showClear]="true" formControlName ="status_id"
                        optionLabel="label" filter="true">
                    </p-dropdown>
                </div>
                <button pButton type="submit" label="Go" class="btn-warning ml-2 p-0"></button>
            </div>
            <!-- <button pButton type="submit" label="Go" class="btn-warning"></button> -->
            <div class="d-flex">
                <div class="input-search">
                    <input type="text" pInputText size="50" placeholder="{{'general.search' | translate}}"
                        class="" (input)="dt.filterGlobal($event.target.value, 'contains')"
                        style="width:auto;">
                    <i class="fa fa-search mr-2"></i>
                </div>
                <!-- <button pButton type="submit" label="Go" class="btn-warning"></button> -->
            </div>
        </div>
    </form>
    <!-- for form ends-->
    <div class="custom-table custon-idlist  custom-lastchild-list custom-row-select student-invoice-list">
        <p-table #dt [columns]="cols" [value]="invoicelist" (onLazyLoad)="loadStudentsInvoiceLazy($event)"
            [paginator]="true" [rows]="10" [lazy]="true" [totalRecords]="totalRecords">
            <ng-template pTemplate="caption">
            </ng-template>
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns; let i = index" [pSortableColumn]="col.field"
                        [ngClass]="(columns.length-2===i) ? 'text-right' : ''">
                        {{col.header}}
                        <p-sortIcon *ngIf="i != 7" [field]="col.field"></p-sortIcon>
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr>
                    <td *ngFor="let col of columns ; let i = index" (click)="viewStudents(rowData)" 
                    [ngClass]="(columns.length-2===i) ? 'text-right' : ''">
                        <span *ngIf="i!=6 && i!=7 && i!=4 && i!=5" title="{{rowData[col.field]}}"
                            x-ms-format-detection="none"> {{rowData[col.field]}}</span>
                        <span *ngIf="i!=6 && i!=7 && i==4" title="{{rowData[col.field] |date:'dd MMM yyy'}}"
                            x-ms-format-detection="none">{{rowData[col.field] |date:'dd MMM yyyy'}}</span>
                        <span *ngIf="i!=6 && i!=7 && i==5" title="{{rowData[col.field]}}" x-ms-format-detection="none">
                            ₹ {{rowData[col.field] |number}}</span>
                        <span *ngIf="i == 6">
                            <span [ngClass]="[(rowData[col.field]==='Paid') ? 'bg-brown' : '',
                                    (rowData[col.field]==='OverDue')? 'bg-gold' : '',
                                    (rowData[col.field]==='Due')? 'bg-orange' : '',
                                    (rowData[col.field]==='Invoiced')? 'bg-darkblue' : '']"
                                class='list-status'>{{rowData[col.field]}}
                            </span>
                        </span>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="footer" let-columns>
                <ng-container *ngIf="isEmptyTable()">
                    <tr>
                        <td [attr.colspan]="columns.length" class="text-center">
                            {{'general.noRecords' | translate}}
                        </td>
                    </tr>
                </ng-container>
            </ng-template>
        </p-table>
    </div>
</div>